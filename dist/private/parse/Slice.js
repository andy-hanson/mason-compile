if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', 'esast/dist/Loc', '../util'], function (exports, module, _esastDistLoc, _util) {
	'use strict';

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

	var _Loc = _interopRequireDefault(_esastDistLoc);

	/*
 Represents a section of tokens that the parser is currently working on.
 Since we don't modify the Token tree, this is just a view on it.
 So, taking the tail is O(1).
 */

	class Slice {
		static group(groupToken) {
			const subTokens = groupToken.subTokens;
			const loc = groupToken.loc;

			return new Slice(subTokens, 0, subTokens.length, loc);
		}

		// Do not use `new`. Use Slice.group.
		constructor(tokens, start, end, loc) {
			this.tokens = tokens;
			this.start = start;
			// end is exclusive.
			this.end = end;
			this.loc = loc;
		}

		size() {
			return this.end - this.start;
		}

		isEmpty() {
			return this.start === this.end;
		}

		// For these methods, caller must ensure non-empty.
		head() {
			return this.tokens[this.start];
		}
		headSlice() {
			return Slice.group(this.head());
		}

		second() {
			return this.tokens[this.start + 1];
		}

		last() {
			return this.tokens[this.end - 1];
		}

		tail() {
			return this._chopStart(this.start + 1);
		}

		rtail() {
			return this._chopEnd(this.end - 1);
		}

		// Looks for the first token to satisfy `splitOn` and does not look further.
		opSplitOnceWhere(splitOn) {
			for (let i = this.start; i < this.end; i = i + 1) if (splitOn(this.tokens[i])) return {
				before: this._chopEnd(i),
				at: this.tokens[i],
				after: this._chopStart(i + 1)
			};
			return null;
		}

		// Splits every time  `splitOn` is true.
		// Every output but last will be { before, at }; last will be just { before }.
		opSplitManyWhere(splitOn) {
			let iLast = this.start;
			const out = [];
			for (let i = this.start; i < this.end; i = i + 1) if (splitOn(this.tokens[i])) {
				out.push({ before: this._chop(iLast, i), at: this.tokens[i] });
				iLast = i + 1;
			}
			return (0, _util.opIf)(!(0, _util.isEmpty)(out), () => (0, _util.push)(out, { before: this._chopStart(iLast) }));
		}

		each(f) {
			for (let i = this.start; i < this.end; i = i + 1) f(this.tokens[i]);
		}

		map(f) {
			const out = [];
			for (let i = this.start; i < this.end; i = i + 1) out.push(f(this.tokens[i]));
			return out;
		}
		mapSlices(f) {
			const out = [];
			for (let i = this.start; i < this.end; i = i + 1) out.push(f(Slice.group(this.tokens[i])));
			return out;
		}

		reduce(reducer, start) {
			let acc = start;
			this.each(_ => acc = reducer(acc, _));
			return acc;
		}

		_chop(newStart, newEnd) {
			const loc = new _Loc.default(this.tokens[newStart].loc.start, this.tokens[newEnd - 1].loc.end);
			return new Slice(this.tokens, newStart, newEnd, loc);
		}
		_chopStart(newStart) {
			const loc = newStart === this.end ? this.loc : new _Loc.default(this.tokens[newStart].loc.start, this.loc.end);
			return new Slice(this.tokens, newStart, this.end, loc);
		}
		_chopEnd(newEnd) {
			const loc = newEnd === this.start ? this.loc : new _Loc.default(this.loc.start, this.tokens[newEnd - 1].loc.end);
			return new Slice(this.tokens, this.start, newEnd, loc);
		}
	}

	module.exports = Slice;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNsaWNlLmpzIiwicHJpdmF0ZS9wYXJzZS9TbGljZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7OztBQ1FlLE9BQU0sS0FBSyxDQUFDO0FBQzFCLFNBQU8sS0FBSyxDQUFDLFVBQVUsRUFBRTtTQUNoQixTQUFTLEdBQVUsVUFBVSxDQUE3QixTQUFTO1NBQUUsR0FBRyxHQUFLLFVBQVUsQ0FBbEIsR0FBRzs7QUFDdEIsVUFBTyxJQUFJLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUE7R0FDckQ7OztBQUdELGFBQVcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUU7QUFDcEMsT0FBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUE7QUFDcEIsT0FBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUE7O0FBRWxCLE9BQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFBO0FBQ2QsT0FBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUE7R0FDZDs7QUFFRCxNQUFJLEdBQUc7QUFDTixVQUFPLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQTtHQUM1Qjs7QUFFRCxTQUFPLEdBQUc7QUFDVCxVQUFPLElBQUksQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQTtHQUM5Qjs7O0FBR0QsTUFBSSxHQUFHO0FBQ04sVUFBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtHQUM5QjtBQUNELFdBQVMsR0FBRztBQUNYLFVBQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQTtHQUMvQjs7QUFFRCxRQUFNLEdBQUc7QUFDUixVQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQTtHQUNsQzs7QUFFRCxNQUFJLEdBQUc7QUFDTixVQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQTtHQUNoQzs7QUFFRCxNQUFJLEdBQUc7QUFDTixVQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQTtHQUN0Qzs7QUFFRCxPQUFLLEdBQUc7QUFDUCxVQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQTtHQUNsQzs7O0FBR0Qsa0JBQWdCLENBQUMsT0FBTyxFQUFFO0FBQ3pCLFFBQUssSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFDL0MsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUMxQixPQUFPO0FBQ04sVUFBTSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQ3hCLE1BQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNsQixTQUFLLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLENBQUE7QUFDSCxVQUFPLElBQUksQ0FBQTtHQUNYOzs7O0FBSUQsa0JBQWdCLENBQUMsT0FBTyxFQUFFO0FBQ3pCLE9BQUksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUE7QUFDdEIsU0FBTSxHQUFHLEdBQUcsRUFBRyxDQUFBO0FBQ2YsUUFBSyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUMvQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDNUIsT0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUE7QUFDOUQsU0FBSyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDYjtBQUNGLFVBQU8sVUE1RVMsSUFBSSxFQTRFUixDQUFDLFVBNUVOLE9BQU8sRUE0RU8sR0FBRyxDQUFDLEVBQUUsTUFBTSxVQTVFWCxJQUFJLEVBNEVZLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0dBQy9FOztBQUVELE1BQUksQ0FBQyxDQUFDLEVBQUU7QUFDUCxRQUFLLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQy9DLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7R0FDbEI7O0FBRUQsS0FBRyxDQUFDLENBQUMsRUFBRTtBQUNOLFNBQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQTtBQUNkLFFBQUssSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFDL0MsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDNUIsVUFBTyxHQUFHLENBQUE7R0FDVjtBQUNELFdBQVMsQ0FBQyxDQUFDLEVBQUU7QUFDWixTQUFNLEdBQUcsR0FBRyxFQUFFLENBQUE7QUFDZCxRQUFLLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQy9DLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUN6QyxVQUFPLEdBQUcsQ0FBQTtHQUNWOztBQUVELFFBQU0sQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3RCLE9BQUksR0FBRyxHQUFHLEtBQUssQ0FBQTtBQUNmLE9BQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDckMsVUFBTyxHQUFHLENBQUE7R0FDVjs7QUFFRCxPQUFLLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRTtBQUN2QixTQUFNLEdBQUcsR0FBRyxpQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ3JGLFVBQU8sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFBO0dBQ3BEO0FBQ0QsWUFBVSxDQUFDLFFBQVEsRUFBRTtBQUNwQixTQUFNLEdBQUcsR0FBRyxRQUFRLEtBQUssSUFBSSxDQUFDLEdBQUcsR0FDaEMsSUFBSSxDQUFDLEdBQUcsR0FDUixpQkFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUN2RCxVQUFPLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUE7R0FDdEQ7QUFDRCxVQUFRLENBQUMsTUFBTSxFQUFFO0FBQ2hCLFNBQU0sR0FBRyxHQUFHLE1BQU0sS0FBSyxJQUFJLENBQUMsS0FBSyxHQUNoQyxJQUFJLENBQUMsR0FBRyxHQUNSLGlCQUFRLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUN6RCxVQUFPLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUE7R0FDdEQ7RUFDRDs7a0JBaEhvQixLQUFLIiwiZmlsZSI6InByaXZhdGUvcGFyc2UvU2xpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6W251bGwsImltcG9ydCBMb2MgZnJvbSAnZXNhc3QvZGlzdC9Mb2MnXG5pbXBvcnQgeyBpc0VtcHR5LCBvcElmLCBwdXNoIH0gZnJvbSAnLi4vdXRpbCdcblxuLypcblJlcHJlc2VudHMgYSBzZWN0aW9uIG9mIHRva2VucyB0aGF0IHRoZSBwYXJzZXIgaXMgY3VycmVudGx5IHdvcmtpbmcgb24uXG5TaW5jZSB3ZSBkb24ndCBtb2RpZnkgdGhlIFRva2VuIHRyZWUsIHRoaXMgaXMganVzdCBhIHZpZXcgb24gaXQuXG5TbywgdGFraW5nIHRoZSB0YWlsIGlzIE8oMSkuXG4qL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2xpY2Uge1xuXHRzdGF0aWMgZ3JvdXAoZ3JvdXBUb2tlbikge1xuXHRcdGNvbnN0IHsgc3ViVG9rZW5zLCBsb2MgfSA9IGdyb3VwVG9rZW5cblx0XHRyZXR1cm4gbmV3IFNsaWNlKHN1YlRva2VucywgMCwgc3ViVG9rZW5zLmxlbmd0aCwgbG9jKVxuXHR9XG5cblx0Ly8gRG8gbm90IHVzZSBgbmV3YC4gVXNlIFNsaWNlLmdyb3VwLlxuXHRjb25zdHJ1Y3Rvcih0b2tlbnMsIHN0YXJ0LCBlbmQsIGxvYykge1xuXHRcdHRoaXMudG9rZW5zID0gdG9rZW5zXG5cdFx0dGhpcy5zdGFydCA9IHN0YXJ0XG5cdFx0Ly8gZW5kIGlzIGV4Y2x1c2l2ZS5cblx0XHR0aGlzLmVuZCA9IGVuZFxuXHRcdHRoaXMubG9jID0gbG9jXG5cdH1cblxuXHRzaXplKCkge1xuXHRcdHJldHVybiB0aGlzLmVuZCAtIHRoaXMuc3RhcnRcblx0fVxuXG5cdGlzRW1wdHkoKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3RhcnQgPT09IHRoaXMuZW5kXG5cdH1cblxuXHQvLyBGb3IgdGhlc2UgbWV0aG9kcywgY2FsbGVyIG11c3QgZW5zdXJlIG5vbi1lbXB0eS5cblx0aGVhZCgpIHtcblx0XHRyZXR1cm4gdGhpcy50b2tlbnNbdGhpcy5zdGFydF1cblx0fVxuXHRoZWFkU2xpY2UoKSB7XG5cdFx0cmV0dXJuIFNsaWNlLmdyb3VwKHRoaXMuaGVhZCgpKVxuXHR9XG5cblx0c2Vjb25kKCkge1xuXHRcdHJldHVybiB0aGlzLnRva2Vuc1t0aGlzLnN0YXJ0ICsgMV1cblx0fVxuXG5cdGxhc3QoKSB7XG5cdFx0cmV0dXJuIHRoaXMudG9rZW5zW3RoaXMuZW5kIC0gMV1cblx0fVxuXG5cdHRhaWwoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2Nob3BTdGFydCh0aGlzLnN0YXJ0ICsgMSlcblx0fVxuXG5cdHJ0YWlsKCkge1xuXHRcdHJldHVybiB0aGlzLl9jaG9wRW5kKHRoaXMuZW5kIC0gMSlcblx0fVxuXG5cdC8vIExvb2tzIGZvciB0aGUgZmlyc3QgdG9rZW4gdG8gc2F0aXNmeSBgc3BsaXRPbmAgYW5kIGRvZXMgbm90IGxvb2sgZnVydGhlci5cblx0b3BTcGxpdE9uY2VXaGVyZShzcGxpdE9uKSB7XG5cdFx0Zm9yIChsZXQgaSA9IHRoaXMuc3RhcnQ7IGkgPCB0aGlzLmVuZDsgaSA9IGkgKyAxKVxuXHRcdFx0aWYgKHNwbGl0T24odGhpcy50b2tlbnNbaV0pKVxuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdGJlZm9yZTogdGhpcy5fY2hvcEVuZChpKSxcblx0XHRcdFx0XHRhdDogdGhpcy50b2tlbnNbaV0sXG5cdFx0XHRcdFx0YWZ0ZXI6IHRoaXMuX2Nob3BTdGFydChpICsgMSlcblx0XHRcdFx0fVxuXHRcdHJldHVybiBudWxsXG5cdH1cblxuXHQvLyBTcGxpdHMgZXZlcnkgdGltZSAgYHNwbGl0T25gIGlzIHRydWUuXG5cdC8vIEV2ZXJ5IG91dHB1dCBidXQgbGFzdCB3aWxsIGJlIHsgYmVmb3JlLCBhdCB9OyBsYXN0IHdpbGwgYmUganVzdCB7IGJlZm9yZSB9LlxuXHRvcFNwbGl0TWFueVdoZXJlKHNwbGl0T24pIHtcblx0XHRsZXQgaUxhc3QgPSB0aGlzLnN0YXJ0XG5cdFx0Y29uc3Qgb3V0ID0gWyBdXG5cdFx0Zm9yIChsZXQgaSA9IHRoaXMuc3RhcnQ7IGkgPCB0aGlzLmVuZDsgaSA9IGkgKyAxKVxuXHRcdFx0aWYgKHNwbGl0T24odGhpcy50b2tlbnNbaV0pKSB7XG5cdFx0XHRcdG91dC5wdXNoKHsgYmVmb3JlOiB0aGlzLl9jaG9wKGlMYXN0LCBpKSwgYXQ6IHRoaXMudG9rZW5zW2ldIH0pXG5cdFx0XHRcdGlMYXN0ID0gaSArIDFcblx0XHRcdH1cblx0XHRyZXR1cm4gb3BJZighaXNFbXB0eShvdXQpLCAoKSA9PiBwdXNoKG91dCwgeyBiZWZvcmU6IHRoaXMuX2Nob3BTdGFydChpTGFzdCkgfSkpXG5cdH1cblxuXHRlYWNoKGYpIHtcblx0XHRmb3IgKGxldCBpID0gdGhpcy5zdGFydDsgaSA8IHRoaXMuZW5kOyBpID0gaSArIDEpXG5cdFx0XHRmKHRoaXMudG9rZW5zW2ldKVxuXHR9XG5cblx0bWFwKGYpIHtcblx0XHRjb25zdCBvdXQgPSBbXVxuXHRcdGZvciAobGV0IGkgPSB0aGlzLnN0YXJ0OyBpIDwgdGhpcy5lbmQ7IGkgPSBpICsgMSlcblx0XHRcdG91dC5wdXNoKGYodGhpcy50b2tlbnNbaV0pKVxuXHRcdHJldHVybiBvdXRcblx0fVxuXHRtYXBTbGljZXMoZikge1xuXHRcdGNvbnN0IG91dCA9IFtdXG5cdFx0Zm9yIChsZXQgaSA9IHRoaXMuc3RhcnQ7IGkgPCB0aGlzLmVuZDsgaSA9IGkgKyAxKVxuXHRcdFx0b3V0LnB1c2goZihTbGljZS5ncm91cCh0aGlzLnRva2Vuc1tpXSkpKVxuXHRcdHJldHVybiBvdXRcblx0fVxuXG5cdHJlZHVjZShyZWR1Y2VyLCBzdGFydCkge1xuXHRcdGxldCBhY2MgPSBzdGFydFxuXHRcdHRoaXMuZWFjaChfID0+IGFjYyA9IHJlZHVjZXIoYWNjLCBfKSlcblx0XHRyZXR1cm4gYWNjXG5cdH1cblxuXHRfY2hvcChuZXdTdGFydCwgbmV3RW5kKSB7XG5cdFx0Y29uc3QgbG9jID0gbmV3IExvYyh0aGlzLnRva2Vuc1tuZXdTdGFydF0ubG9jLnN0YXJ0LCB0aGlzLnRva2Vuc1tuZXdFbmQgLSAxXS5sb2MuZW5kKVxuXHRcdHJldHVybiBuZXcgU2xpY2UodGhpcy50b2tlbnMsIG5ld1N0YXJ0LCBuZXdFbmQsIGxvYylcblx0fVxuXHRfY2hvcFN0YXJ0KG5ld1N0YXJ0KSB7XG5cdFx0Y29uc3QgbG9jID0gbmV3U3RhcnQgPT09IHRoaXMuZW5kID9cblx0XHRcdHRoaXMubG9jIDpcblx0XHRcdG5ldyBMb2ModGhpcy50b2tlbnNbbmV3U3RhcnRdLmxvYy5zdGFydCwgdGhpcy5sb2MuZW5kKVxuXHRcdHJldHVybiBuZXcgU2xpY2UodGhpcy50b2tlbnMsIG5ld1N0YXJ0LCB0aGlzLmVuZCwgbG9jKVxuXHR9XG5cdF9jaG9wRW5kKG5ld0VuZCkge1xuXHRcdGNvbnN0IGxvYyA9IG5ld0VuZCA9PT0gdGhpcy5zdGFydCA/XG5cdFx0XHR0aGlzLmxvYyA6XG5cdFx0XHRuZXcgTG9jKHRoaXMubG9jLnN0YXJ0LCB0aGlzLnRva2Vuc1tuZXdFbmQgLSAxXS5sb2MuZW5kKVxuXHRcdHJldHVybiBuZXcgU2xpY2UodGhpcy50b2tlbnMsIHRoaXMuc3RhcnQsIG5ld0VuZCwgbG9jKVxuXHR9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==