if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', '../CompileError', 'esast/dist/Loc'], function (exports, module, _CompileError, _esastDistLoc) {
	'use strict';

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

	var _CompileError2 = _interopRequireDefault(_CompileError);

	class CompileContext {
		constructor(opts) {
			this.opts = opts;
			this.warnings = [];
		}

		check(cond, loc, message) {
			if (!cond) this.fail(loc, message);
		}

		fail(loc, message) {
			throw (0, _CompileError2.default)(warning(loc, message));
		}

		warn(loc, message) {
			if (this.opts.warnAsError()) this.fail(loc, message);else this.warnings.push(warning(loc, message));
		}

		warnIf(cond, loc, message) {
			if (cond) this.warn(loc, message);
		}
	}

	module.exports = CompileContext;

	const unlazy = _ => _ instanceof Function ? _() : _,
	      warning = (loc, message) => {
		loc = unlazy(loc);
		message = unlazy(message);
		if (loc instanceof _esastDistLoc.Pos) loc = (0, _esastDistLoc.singleCharLoc)(loc);
		return new _CompileError.Warning(loc, message);
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbXBpbGVDb250ZXh0LmpzIiwicHJpdmF0ZS9Db21waWxlQ29udGV4dC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQ0dlLE9BQU0sY0FBYyxDQUFDO0FBQ25DLGFBQVcsQ0FBQyxJQUFJLEVBQUU7QUFDakIsT0FBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUE7QUFDaEIsT0FBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUE7R0FDbEI7O0FBRUQsT0FBSyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFO0FBQ3pCLE9BQUksQ0FBQyxJQUFJLEVBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUE7R0FDeEI7O0FBRUQsTUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7QUFDbEIsU0FBTSw0QkFBYSxPQUFPLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7R0FDekM7O0FBRUQsTUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7QUFDbEIsT0FBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQSxLQUV2QixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7R0FDMUM7O0FBRUQsUUFBTSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFO0FBQzFCLE9BQUksSUFBSSxFQUNQLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFBO0dBQ3hCO0VBQ0Q7O2tCQTFCb0IsY0FBYzs7QUE0Qm5DLE9BQ0MsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksUUFBUSxHQUFHLENBQUMsRUFBRSxHQUFHLENBQUM7T0FFN0MsT0FBTyxHQUFHLENBQUMsR0FBRyxFQUFFLE9BQU8sS0FBSztBQUMzQixLQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ2pCLFNBQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDekIsTUFBSSxHQUFHLDBCQXBDQSxHQUFHLEFBb0NZLEVBQ3JCLEdBQUcsR0FBRyxrQkFyQ0ssYUFBYSxFQXFDSixHQUFHLENBQUMsQ0FBQTtBQUN6QixTQUFPLGtCQXZDYyxPQUFPLENBdUNULEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtFQUNoQyxDQUFBIiwiZmlsZSI6InByaXZhdGUvQ29tcGlsZUNvbnRleHQuanMiLCJzb3VyY2VzQ29udGVudCI6W251bGwsImltcG9ydCBDb21waWxlRXJyb3IsIHsgV2FybmluZyB9IGZyb20gJy4uL0NvbXBpbGVFcnJvcidcbmltcG9ydCB7IFBvcywgc2luZ2xlQ2hhckxvYyB9IGZyb20gJ2VzYXN0L2Rpc3QvTG9jJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21waWxlQ29udGV4dCB7XG5cdGNvbnN0cnVjdG9yKG9wdHMpIHtcblx0XHR0aGlzLm9wdHMgPSBvcHRzXG5cdFx0dGhpcy53YXJuaW5ncyA9IFtdXG5cdH1cblxuXHRjaGVjayhjb25kLCBsb2MsIG1lc3NhZ2UpIHtcblx0XHRpZiAoIWNvbmQpXG5cdFx0XHR0aGlzLmZhaWwobG9jLCBtZXNzYWdlKVxuXHR9XG5cblx0ZmFpbChsb2MsIG1lc3NhZ2UpIHtcblx0XHR0aHJvdyBDb21waWxlRXJyb3Iod2FybmluZyhsb2MsIG1lc3NhZ2UpKVxuXHR9XG5cblx0d2Fybihsb2MsIG1lc3NhZ2UpIHtcblx0XHRpZiAodGhpcy5vcHRzLndhcm5Bc0Vycm9yKCkpXG5cdFx0XHR0aGlzLmZhaWwobG9jLCBtZXNzYWdlKVxuXHRcdGVsc2Vcblx0XHRcdHRoaXMud2FybmluZ3MucHVzaCh3YXJuaW5nKGxvYywgbWVzc2FnZSkpXG5cdH1cblxuXHR3YXJuSWYoY29uZCwgbG9jLCBtZXNzYWdlKSB7XG5cdFx0aWYgKGNvbmQpXG5cdFx0XHR0aGlzLndhcm4obG9jLCBtZXNzYWdlKVxuXHR9XG59XG5cbmNvbnN0XG5cdHVubGF6eSA9IF8gPT4gXyBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gXygpIDogXyxcblxuXHR3YXJuaW5nID0gKGxvYywgbWVzc2FnZSkgPT4ge1xuXHRcdGxvYyA9IHVubGF6eShsb2MpXG5cdFx0bWVzc2FnZSA9IHVubGF6eShtZXNzYWdlKVxuXHRcdGlmIChsb2MgaW5zdGFuY2VvZiBQb3MpXG5cdFx0XHRsb2MgPSBzaW5nbGVDaGFyTG9jKGxvYylcblx0XHRyZXR1cm4gbmV3IFdhcm5pbmcobG9jLCBtZXNzYWdlKVxuXHR9XG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==