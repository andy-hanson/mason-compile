{"version":3,"sources":["private/parse/parseClass.js"],"names":[],"mappings":"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","file":"private/parse/parseClass.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../ast/Class', '../ast/Fun', '../context', '../token/Keyword', './parseBlock', './parseExpr', './parseFun', './parseMethodImpls', './parseLocalDeclares', './tryTakeComment'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var Class_1 = require('../ast/Class');\n    var Fun_1 = require('../ast/Fun');\n    var context_1 = require('../context');\n    var Keyword_1 = require('../token/Keyword');\n    var parseBlock_1 = require('./parseBlock');\n    var parseExpr_1 = require('./parseExpr');\n    var parseFun_1 = require('./parseFun');\n    var parseMethodImpls_1 = require('./parseMethodImpls');\n    var parseLocalDeclares_1 = require('./parseLocalDeclares');\n    var tryTakeComment_1 = require('./tryTakeComment');\n    function parseClass(tokens) {\n        const [before, opBlock] = parseBlock_1.beforeAndOpBlock(tokens);\n        const { opFields, opSuperClass, traits } = parseClassHeader(before);\n        const [opComment, opDo, statics, opConstructor, methods] = Op_1.caseOp(opBlock, _ => {\n            const [opComment, rest] = tryTakeComment_1.default(_);\n            if (rest.isEmpty())\n                return [opComment, null, [], null, []];\n            const [opDo, rest2] = parseMethodImpls_1.opTakeDo(rest);\n            if (rest2.isEmpty())\n                return [opComment, opDo, [], null, []];\n            const [statics, rest3] = parseMethodImpls_1.takeStatics(rest2);\n            if (rest3.isEmpty())\n                return [opComment, opDo, statics, null, []];\n            const [opConstructor, rest4] = opTakeConstructor(rest3);\n            return [opComment, opDo, statics, opConstructor, parseMethodImpls_1.default(rest4)];\n        }, () => [null, null, [], null, []]);\n        return new Class_1.default(tokens.loc, opFields, opSuperClass, traits, opComment, opDo, statics, opConstructor, methods);\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = parseClass;\n    function parseClassHeader(tokens) {\n        const [fieldsTokens, [extendsTokens, traitTokens]] = tokens.getKeywordSections([99, 148]);\n        return {\n            opFields: Op_1.opIf(!fieldsTokens.isEmpty(), () => fieldsTokens.map(_ => {\n                const { name, opType, kind } = parseLocalDeclares_1.parseLocalParts(_);\n                context_1.check(kind === 0, _.loc, _ => _.todoLazyField);\n                return new Class_1.Field(_.loc, name, opType);\n            })),\n            opSuperClass: Op_1.opMap(extendsTokens, parseExpr_1.default),\n            traits: Op_1.caseOp(traitTokens, parseExpr_1.parseExprParts, () => [])\n        };\n    }\n    function opTakeConstructor(tokens) {\n        const line = tokens.headSlice();\n        return Keyword_1.isKeyword(90, line.head()) ?\n            [parseConstructor(line.tail()), tokens.tail()] :\n            [null, tokens];\n    }\n    function parseConstructor(tokens) {\n        const { args, memberArgs, opRestArg, block } = parseFun_1.funArgsAndBlock(tokens, false, true);\n        const fun = new Fun_1.default(tokens.loc, args, opRestArg, block, { isThisFun: true, isDo: true });\n        return new Class_1.Constructor(tokens.loc, fun, memberArgs);\n    }\n});\n"],"sourceRoot":"/source/"}