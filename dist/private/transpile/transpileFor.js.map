{"version":3,"sources":["private/transpile/transpileFor.js"],"names":[],"mappings":"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","file":"private/transpile/transpileFor.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'esast/lib/ast', 'op/Op', './ast-constants', './context', './util'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ast_1 = require('esast/lib/ast');\n    var Op_1 = require('op/Op');\n    var ast_constants_1 = require('./ast-constants');\n    var context_1 = require('./context');\n    var util_1 = require('./util');\n    function transpileBreak() {\n        return Op_1.caseOp(this.opValue, _ => new ast_1.ReturnStatement(util_1.t0(_)), () => new ast_1.BreakStatement(context_1.verifyResults.isBreakInSwitch(this) ? IdLoop : null));\n    }\n    exports.transpileBreak = transpileBreak;\n    function transpileFor() {\n        const loop = forLoop(this.opIteratee, this.block);\n        return context_1.verifyResults.isStatement(this) ?\n            maybeLabelLoop(this, loop) :\n            util_1.blockWrap(new ast_1.BlockStatement([loop]));\n    }\n    exports.transpileFor = transpileFor;\n    function transpileForAsync() {\n        const { element, bag } = this.iteratee;\n        const func = new ast_1.FunctionExpression(null, [util_1.t0(element)], util_1.t0(this.block), { generator: true });\n        const call = util_1.msCall('$for', util_1.t0(bag), func);\n        return context_1.verifyResults.isStatement(this) ? new ast_1.YieldExpression(call) : call;\n    }\n    exports.transpileForAsync = transpileForAsync;\n    function transpileForBag() {\n        const loop = maybeLabelLoop(this, forLoop(this.opIteratee, this.block));\n        return util_1.blockWrap(new ast_1.BlockStatement([ast_constants_1.DeclareBuiltBag, loop, ReturnBuilt]));\n    }\n    exports.transpileForBag = transpileForBag;\n    function forLoop(opIteratee, block) {\n        const jsBlock = util_1.t0(block);\n        return Op_1.caseOp(opIteratee, ({ element, bag }) => new ast_1.ForOfStatement(new ast_1.VariableDeclaration('let', [new ast_1.VariableDeclarator(util_1.t0(element))]), util_1.t0(bag), jsBlock), () => new ast_1.ForStatement(null, null, null, jsBlock));\n    }\n    function maybeLabelLoop(ast, loop) {\n        return context_1.verifyResults.loopNeedsLabel(ast) ? new ast_1.LabeledStatement(IdLoop, loop) : loop;\n    }\n    const IdLoop = new ast_1.Identifier('loop');\n    const ReturnBuilt = new ast_1.ReturnStatement(ast_constants_1.IdBuilt);\n});\n"],"sourceRoot":"/source/"}