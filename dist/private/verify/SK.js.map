{"version":3,"sources":["private/verify/SK.js"],"names":[],"mappings":"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","file":"private/verify/SK.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../MsAst', '../util', './autoBlockKind', './context'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var context_1 = require('../context');\n    var MsAst_1 = require('../MsAst');\n    var util_1 = require('../util');\n    var autoBlockKind_1 = require('./autoBlockKind');\n    var context_2 = require('./context');\n    function markStatement(_, sk) {\n        if (sk === 0)\n            context_2.results.statements.add(_);\n    }\n    exports.markStatement = markStatement;\n    function getBlockSK(_) {\n        return Op_1.orDefault(opBlockSK(_), () => 1);\n    }\n    exports.getBlockSK = getBlockSK;\n    function getLineSK(_) {\n        return Op_1.orDefault(opSK(_), () => 1);\n    }\n    exports.getLineSK = getLineSK;\n    function opBlockSK({ lines, loc }) {\n        return autoBlockKind_1.default(lines, loc) === 2 ?\n            util_1.isEmpty(lines) ? 0 : opSK(util_1.last(lines)) :\n            1;\n    }\n    function opSK(_) {\n        if (_ instanceof MsAst_1.DoOnly)\n            return 0;\n        else if (_ instanceof MsAst_1.ValOnly)\n            return 1;\n        else if (_ instanceof MsAst_1.Conditional) {\n            const { result } = _;\n            return result instanceof MsAst_1.Block ? opBlockSK(result) : opSK(result);\n        }\n        else if (_ instanceof MsAst_1.Except) {\n            const { loc, try: _try, allCatches, opElse } = _;\n            const catches = allCatches.map((_) => _.block);\n            const parts = Op_1.caseOp(opElse, _ => util_1.cat(_, catches), () => util_1.cat(_try, catches));\n            return compositeSK(loc, parts.map(opBlockSK));\n        }\n        else if (_ instanceof MsAst_1.For)\n            return Op_1.orDefault(opForSKBlock(_.block), () => 0);\n        else if (_ instanceof MsAst_1.Case || _ instanceof MsAst_1.Switch)\n            return compositeSK(_.loc, caseSwitchParts(_).map(opBlockSK));\n        else\n            return null;\n    }\n    function opForSKBlock({ loc, lines }) {\n        return util_1.isEmpty(lines) ? null : compositeForSK(loc, lines.map(opForSK));\n    }\n    function opForSK(_) {\n        if (_ instanceof MsAst_1.Break)\n            return _.opValue === null ? 0 : 1;\n        else if (_ instanceof MsAst_1.Conditional) {\n            const { result } = _;\n            return result instanceof MsAst_1.Block ? opForSKBlock(result) : opForSK(result);\n        }\n        else if (_ instanceof MsAst_1.Except) {\n            const { loc, try: _try, allCatches, opElse, opFinally } = _;\n            const catches = allCatches.map(_ => _.block);\n            return compositeForSK(loc, util_1.cat(_try, catches, opElse, opFinally).map(opForSKBlock));\n        }\n        else if (_ instanceof MsAst_1.With)\n            return opForSKBlock(_.block);\n        else if (_ instanceof MsAst_1.Case || _ instanceof MsAst_1.Switch)\n            return compositeForSK(_.loc, caseSwitchParts(_).map(opForSKBlock));\n        else\n            return null;\n    }\n    function caseSwitchParts({ parts, opElse }) {\n        const prts = parts;\n        return util_1.cat(prts.map(_ => _.result), opElse);\n    }\n    function compositeSK(loc, parts) {\n        return composite(loc, parts, _ => _.ambiguousSK);\n    }\n    function compositeForSK(loc, parts) {\n        return composite(loc, parts, _ => _.ambiguousForSK);\n    }\n    function composite(loc, sks, errorMessage) {\n        let opSk = sks[0];\n        for (let i = 1; i < sks.length; i = i + 1) {\n            const otherSK = sks[i];\n            if (opSk === null)\n                opSk = otherSK;\n            else\n                context_1.check(otherSK === null || otherSK === opSk, loc, errorMessage);\n        }\n        return opSk;\n    }\n});\n"],"sourceRoot":"/source/"}