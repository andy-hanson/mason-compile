{"version":3,"sources":["private/verify/verifyVal.js"],"names":[],"mappings":"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","file":"private/verify/verifyVal.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../MsAst', './context', './locals', './util', './verifyBlock', './verifyClass', './verifyFor', './verifyFunLike', './verifyFunLike', './verifyTrait', './verifyValOrDo'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var context_1 = require('../context');\n    var MsAst_1 = require('../MsAst');\n    var context_2 = require('./context');\n    var locals_1 = require('./locals');\n    var util_1 = require('./util');\n    var verifyBlock_1 = require('./verifyBlock');\n    var verifyClass_1 = require('./verifyClass');\n    var verifyFor_1 = require('./verifyFor');\n    var verifyFunLike_1 = require('./verifyFunLike');\n    var verifyFunLike_2 = require('./verifyFunLike');\n    var verifyTrait_1 = require('./verifyTrait');\n    var verifyValOrDo_1 = require('./verifyValOrDo');\n    function verifyVal(_) {\n        if (_ instanceof MsAst_1.BagSimple)\n            util_1.verifyEachValOrSpread(_.parts);\n        else if (_ instanceof MsAst_1.BlockWrap)\n            context_2.withIife(() => verifyBlock_1.verifyBlockVal(_.block));\n        else if (_ instanceof MsAst_1.Class)\n            verifyClass_1.default(_);\n        else if (_ instanceof MsAst_1.ForBag)\n            locals_1.verifyAndPlusLocal(_.built, () => verifyFor_1.default(_));\n        else if (_ instanceof MsAst_1.Fun)\n            verifyFunLike_2.verifyFun(_);\n        else if (_ instanceof MsAst_1.GetterFun)\n            util_1.verifyName(_.name);\n        else if (_ instanceof MsAst_1.InstanceOf) {\n            const { instance, type } = _;\n            verifyVal(instance);\n            verifyVal(type);\n        }\n        else if (_ instanceof MsAst_1.Lazy)\n            locals_1.withBlockLocals(() => verifyVal(_.value));\n        else if (_ instanceof MsAst_1.LocalAccess) {\n            const { loc, name } = _;\n            const declare = context_2.locals.get(name);\n            if (declare === undefined) {\n                const builtinPath = Op_1.orThrow(context_1.options.opBuiltinPath(name), () => locals_1.missingLocalFail(loc, name));\n                context_2.results.accessBuiltin(name, builtinPath);\n            }\n            else {\n                context_2.results.localAccessToDeclare.set(_, declare);\n                locals_1.setDeclareAccessed(declare, _);\n            }\n        }\n        else if (_ instanceof MsAst_1.Logic) {\n            const { loc, args } = _;\n            context_1.check(args.length > 1, loc, _ => _.argsLogic);\n            verifyEachVal(args);\n        }\n        else if (_ instanceof MsAst_1.Member) {\n            const { object, name } = _;\n            verifyVal(object);\n            util_1.verifyName(name);\n        }\n        else if (_ instanceof MsAst_1.MemberFun) {\n            const { opObject, name } = _;\n            verifyOpVal(opObject);\n            util_1.verifyName(name);\n        }\n        else if (_ instanceof MsAst_1.Method) {\n            const { fun } = _;\n            if (fun instanceof MsAst_1.Fun)\n                util_1.makeUseOptional(Op_1.orThrow(fun.opDeclareThis));\n            fun.args.forEach(util_1.makeUseOptional);\n            Op_1.opEach(fun.opRestArg, util_1.makeUseOptional);\n            verifyFunLike_1.default(fun);\n        }\n        else if (_ instanceof MsAst_1.Not) {\n            verifyVal(_.arg);\n        }\n        else if (_ instanceof MsAst_1.NumberLiteral) {\n        }\n        else if (_ instanceof MsAst_1.MsRegExp) {\n            const { loc, parts } = _;\n            parts.forEach(util_1.verifyName);\n            const firstPart = parts[0];\n            if (parts.length === 1 && typeof firstPart === 'string')\n                try {\n                    new RegExp(firstPart);\n                }\n                catch (err) {\n                    if (!(err instanceof SyntaxError))\n                        throw err;\n                    throw context_1.fail(loc, _ => _.badRegExp(firstPart));\n                }\n        }\n        else if (_ instanceof MsAst_1.New) {\n            const { type, args } = _;\n            verifyVal(type);\n            util_1.verifyEachValOrSpread(args);\n        }\n        else if (_ instanceof MsAst_1.ObjSimple) {\n            const keys = new Set();\n            for (const { key, value, loc } of _.pairs) {\n                context_1.check(!keys.has(key), loc, _ => _.duplicateKey(key));\n                keys.add(key);\n                verifyVal(value);\n            }\n        }\n        else if (_ instanceof MsAst_1.Pipe) {\n            const { loc, startValue, pipes } = _;\n            verifyVal(startValue);\n            for (const pipe of pipes)\n                locals_1.registerAndPlusLocal(MsAst_1.LocalDeclare.focus(loc), () => {\n                    verifyVal(pipe);\n                });\n        }\n        else if (_ instanceof MsAst_1.QuotePlain) {\n            _.parts.forEach(util_1.verifyName);\n        }\n        else if (_ instanceof MsAst_1.QuoteSimple) {\n        }\n        else if (_ instanceof MsAst_1.QuoteTaggedTemplate) {\n            const { tag, quote } = _;\n            verifyVal(tag);\n            verifyVal(quote);\n        }\n        else if (_ instanceof MsAst_1.Range) {\n            const { start, end } = _;\n            verifyVal(start);\n            verifyOpVal(end);\n        }\n        else if (_ instanceof MsAst_1.SimpleFun) {\n            const { loc, value } = _;\n            context_2.withFun(0, () => {\n                locals_1.registerAndPlusLocal(MsAst_1.LocalDeclare.focus(loc), () => {\n                    verifyVal(value);\n                });\n            });\n        }\n        else if (_ instanceof MsAst_1.SpecialVal) {\n            util_1.setName(_);\n        }\n        else if (_ instanceof MsAst_1.Sub) {\n            const { subbed, args } = _;\n            verifyVal(subbed);\n            verifyEachVal(args);\n        }\n        else if (_ instanceof MsAst_1.SuperMember) {\n            const { loc, name } = _;\n            context_1.check(context_2.method !== null, loc, _ => _.superNeedsMethod);\n            util_1.verifyName(name);\n        }\n        else if (_ instanceof MsAst_1.Trait)\n            verifyTrait_1.default(_);\n        else {\n            verifyValOrDo_1.default(_, 1);\n        }\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = verifyVal;\n    function verifyValP(_) {\n        if (MsAst_1.isVal(_))\n            verifyVal(_);\n        else\n            throw context_1.fail(_.loc, _ => _.statementAsValue);\n    }\n    exports.verifyValP = verifyValP;\n    function verifyOpVal(_) {\n        if (Op_1.nonNull(_))\n            verifyVal(_);\n    }\n    exports.verifyOpVal = verifyOpVal;\n    function verifyEachVal(vals) {\n        for (const _ of vals)\n            verifyVal(_);\n    }\n    exports.verifyEachVal = verifyEachVal;\n});\n"],"sourceRoot":"/source/"}