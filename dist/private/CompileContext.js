if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', '../CompileError', 'esast/dist/Loc'], function (exports, module, _CompileError, _esastDistLoc) {
	'use strict';

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

	var _CompileError2 = _interopRequireDefault(_CompileError);

	class CompileContext {
		constructor(opts) {
			this.opts = opts;
			this.warnings = [];
		}

		check(cond, loc, message) {
			if (!cond) this.fail(loc, message);
		}

		fail(loc, message) {
			throw (0, _CompileError2.default)(warning(loc, message));
		}

		warn(loc, message) {
			if (this.opts.warnAsError()) this.fail(loc, message);else this.warnings.push(warning(loc, message));
		}

		warnIf(cond, loc, message) {
			if (cond) this.warn(loc, message);
		}
	}

	module.exports = CompileContext;

	const unlazy = _ => _ instanceof Function ? _() : _,
	      warning = (loc, message) => {
		loc = unlazy(loc);
		message = unlazy(message);
		if (loc instanceof _esastDistLoc.Pos) loc = (0, _esastDistLoc.singleCharLoc)(loc);
		return new _CompileError.Warning(loc, message);
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbXBpbGVDb250ZXh0LmpzIiwicHJpdmF0ZS9Db21waWxlQ29udGV4dC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQ0dlLE9BQU0sY0FBYyxDQUFDO0FBQ25DLGFBQVcsQ0FBQyxJQUFJLEVBQUU7QUFDakIsT0FBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUE7QUFDaEIsT0FBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUE7R0FDbEI7O0FBRUQsT0FBSyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFO0FBQ3pCLE9BQUksQ0FBQyxJQUFJLEVBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUE7R0FDeEI7O0FBRUQsTUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7QUFDbEIsU0FBTSw0QkFBYSxPQUFPLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7R0FDekM7O0FBRUQsTUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUU7QUFDbEIsT0FBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQSxLQUV2QixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7R0FDMUM7O0FBRUQsUUFBTSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFO0FBQzFCLE9BQUksSUFBSSxFQUNQLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFBO0dBQ3hCO0VBQ0Q7O2tCQTFCb0IsY0FBYzs7QUE0Qm5DLE9BQ0MsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksUUFBUSxHQUFHLENBQUMsRUFBRSxHQUFHLENBQUM7T0FFN0MsT0FBTyxHQUFHLENBQUMsR0FBRyxFQUFFLE9BQU8sS0FBSztBQUMzQixLQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ2pCLFNBQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDekIsTUFBSSxHQUFHLDBCQXBDRCxHQUFHLEFBb0NhLEVBQ3JCLEdBQUcsR0FBRyxrQkFyQ0ksYUFBYSxFQXFDSCxHQUFHLENBQUMsQ0FBQTtBQUN6QixTQUFPLGtCQXZDYSxPQUFPLENBdUNSLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtFQUNoQyxDQUFBIiwiZmlsZSI6InByaXZhdGUvQ29tcGlsZUNvbnRleHQuanMiLCJzb3VyY2VzQ29udGVudCI6W251bGwsImltcG9ydCBDb21waWxlRXJyb3IsIHtXYXJuaW5nfSBmcm9tICcuLi9Db21waWxlRXJyb3InXG5pbXBvcnQge1Bvcywgc2luZ2xlQ2hhckxvY30gZnJvbSAnZXNhc3QvZGlzdC9Mb2MnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbXBpbGVDb250ZXh0IHtcblx0Y29uc3RydWN0b3Iob3B0cykge1xuXHRcdHRoaXMub3B0cyA9IG9wdHNcblx0XHR0aGlzLndhcm5pbmdzID0gW11cblx0fVxuXG5cdGNoZWNrKGNvbmQsIGxvYywgbWVzc2FnZSkge1xuXHRcdGlmICghY29uZClcblx0XHRcdHRoaXMuZmFpbChsb2MsIG1lc3NhZ2UpXG5cdH1cblxuXHRmYWlsKGxvYywgbWVzc2FnZSkge1xuXHRcdHRocm93IENvbXBpbGVFcnJvcih3YXJuaW5nKGxvYywgbWVzc2FnZSkpXG5cdH1cblxuXHR3YXJuKGxvYywgbWVzc2FnZSkge1xuXHRcdGlmICh0aGlzLm9wdHMud2FybkFzRXJyb3IoKSlcblx0XHRcdHRoaXMuZmFpbChsb2MsIG1lc3NhZ2UpXG5cdFx0ZWxzZVxuXHRcdFx0dGhpcy53YXJuaW5ncy5wdXNoKHdhcm5pbmcobG9jLCBtZXNzYWdlKSlcblx0fVxuXG5cdHdhcm5JZihjb25kLCBsb2MsIG1lc3NhZ2UpIHtcblx0XHRpZiAoY29uZClcblx0XHRcdHRoaXMud2Fybihsb2MsIG1lc3NhZ2UpXG5cdH1cbn1cblxuY29uc3Rcblx0dW5sYXp5ID0gXyA9PiBfIGluc3RhbmNlb2YgRnVuY3Rpb24gPyBfKCkgOiBfLFxuXG5cdHdhcm5pbmcgPSAobG9jLCBtZXNzYWdlKSA9PiB7XG5cdFx0bG9jID0gdW5sYXp5KGxvYylcblx0XHRtZXNzYWdlID0gdW5sYXp5KG1lc3NhZ2UpXG5cdFx0aWYgKGxvYyBpbnN0YW5jZW9mIFBvcylcblx0XHRcdGxvYyA9IHNpbmdsZUNoYXJMb2MobG9jKVxuXHRcdHJldHVybiBuZXcgV2FybmluZyhsb2MsIG1lc3NhZ2UpXG5cdH1cbiJdLCJzb3VyY2VSb290IjoiL3NyYyJ9
