{"version":3,"sources":["private/verify/verifyDo.js"],"names":[],"mappings":"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","file":"private/verify/verifyDo.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../MsAst', '../util', './context', './locals', './util', './verifyLocalDeclare', './verifyMethodImplLike', './verifyVal', './verifyValOrDo'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var context_1 = require('../context');\n    var MsAst_1 = require('../MsAst');\n    var util_1 = require('../util');\n    var context_2 = require('./context');\n    var locals_1 = require('./locals');\n    var util_2 = require('./util');\n    var verifyLocalDeclare_1 = require('./verifyLocalDeclare');\n    var verifyMethodImplLike_1 = require('./verifyMethodImplLike');\n    var verifyVal_1 = require('./verifyVal');\n    var verifyValOrDo_1 = require('./verifyValOrDo');\n    function verifyDo(_) {\n        if (_ instanceof MsAst_1.Assert) {\n            verifyVal_1.default(_.condition);\n            verifyVal_1.verifyOpVal(_.opThrown);\n        }\n        else if (_ instanceof MsAst_1.AssignSingle) {\n            const { assignee, value } = _;\n            context_2.withName(assignee.name, () => {\n                const doV = () => {\n                    if (value instanceof MsAst_1.Class ||\n                        value instanceof MsAst_1.Fun ||\n                        value instanceof MsAst_1.Method ||\n                        value instanceof MsAst_1.Trait)\n                        util_2.setName(value);\n                    verifyLocalDeclare_1.justVerifyLocalDeclare(assignee);\n                    verifyVal_1.default(value);\n                };\n                if (assignee.isLazy)\n                    locals_1.withBlockLocals(doV);\n                else\n                    doV();\n            });\n        }\n        else if (_ instanceof MsAst_1.AssignDestructure) {\n            const { assignees, value } = _;\n            for (const _ of assignees)\n                verifyLocalDeclare_1.justVerifyLocalDeclare(_);\n            verifyVal_1.default(value);\n        }\n        else if (_ instanceof MsAst_1.BagEntry) {\n            locals_1.accessLocal(_, 'built');\n            verifyVal_1.default(_.value);\n        }\n        else if (_ instanceof MsAst_1.Break) {\n            const { opValue, loc } = _;\n            verifyVal_1.verifyOpVal(opValue);\n            const loop = Op_1.orThrow(context_2.opLoop, () => context_1.fail(loc, _ => _.misplacedBreak));\n            if (loop instanceof MsAst_1.For)\n                if (context_2.results.isStatement(loop))\n                    context_1.check(opValue === null, loc, _ => _.breakCantHaveValue);\n                else\n                    context_1.check(opValue !== null, loc, _ => _.breakNeedsValue);\n            else {\n                util_1.assert(loop instanceof MsAst_1.ForBag);\n                context_1.check(opValue === null, this.loc, _ => _.breakValInForBag);\n            }\n            if (context_2.isInSwitch) {\n                context_2.results.loopsNeedingLabel.add(loop);\n                context_2.results.breaksInSwitch.add(_);\n            }\n        }\n        else if (_ instanceof MsAst_1.Ignore) {\n            const { ignoredNames } = _;\n            for (const name of ignoredNames)\n                locals_1.accessLocal(_, name);\n        }\n        else if (_ instanceof MsAst_1.LocalMutate) {\n            verifyVal_1.default(_.value);\n        }\n        else if (_ instanceof MsAst_1.MapEntry) {\n            const { key, val } = _;\n            locals_1.accessLocal(_, 'built');\n            verifyVal_1.default(key);\n            verifyVal_1.default(val);\n        }\n        else if (_ instanceof MsAst_1.MemberSet) {\n            const { object, name, opType, value } = _;\n            verifyVal_1.default(object);\n            util_2.verifyName(name);\n            verifyVal_1.verifyOpVal(opType);\n            verifyVal_1.default(value);\n        }\n        else if (_ instanceof MsAst_1.ObjEntryAssign) {\n            const { assign } = _;\n            if (!context_2.results.isObjEntryExport(_))\n                locals_1.accessLocal(_, 'built');\n            verifyDo(assign);\n            for (const assignee of assign.allAssignees())\n                locals_1.setDeclareAccessed(assignee, _);\n        }\n        else if (_ instanceof MsAst_1.ObjEntryPlain) {\n            const { loc, name, value } = _;\n            if (context_2.results.isObjEntryExport(_))\n                context_1.check(typeof name === 'string', loc, _ => _.exportName);\n            else {\n                locals_1.accessLocal(_, 'built');\n                util_2.verifyName(name);\n            }\n            verifyVal_1.default(value);\n        }\n        else if (_ instanceof MsAst_1.Pass) {\n            verifyVal_1.default(_.ignored);\n        }\n        else if (_ instanceof MsAst_1.SetSub) {\n            const { object, subbeds, opType, value } = _;\n            verifyVal_1.default(object);\n            verifyVal_1.verifyEachVal(subbeds);\n            verifyVal_1.verifyOpVal(opType);\n            verifyVal_1.default(value);\n        }\n        else if (_ instanceof MsAst_1.SpecialDo) {\n        }\n        else if (_ instanceof MsAst_1.TraitDo) {\n            const { implementor, trait, statics, methods } = _;\n            verifyVal_1.default(implementor);\n            verifyVal_1.default(trait);\n            context_2.withMethods(() => {\n                for (const _ of statics)\n                    verifyMethodImplLike_1.default(_);\n                for (const _ of methods)\n                    verifyMethodImplLike_1.default(_);\n            });\n        }\n        else {\n            verifyValOrDo_1.default(_, 0);\n        }\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = verifyDo;\n    function verifyDoP(_) {\n        if (MsAst_1.isDo(_))\n            verifyDo(_);\n        else\n            throw context_1.fail(_.loc, _ => _.valueAsStatement);\n    }\n    exports.verifyDoP = verifyDoP;\n    function verifyOpDo(_) {\n        if (Op_1.nonNull(_))\n            verifyDo(_);\n    }\n    exports.verifyOpDo = verifyOpDo;\n});\n"],"sourceRoot":"/source/"}