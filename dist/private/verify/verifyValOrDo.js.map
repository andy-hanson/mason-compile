{"version":3,"sources":["private/verify/verifyValOrDo.js"],"names":[],"mappings":"AAAA,CAAC,UAAU,OAAO,EAAE;AAChB,QAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,OAAO,MAAM,CAAC,OAAO,KAAK,QAAQ,EAAE;AAClE,YAAI,CAAC,GAAG,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,AAAC,IAAI,CAAC,KAAK,SAAS,EAAE,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC;KAC9E,MACI,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,GAAG,EAAE;AACjD,cAAM,CAAC,CAAC,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,YAAY,EAAE,UAAU,EAAE,WAAW,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAE,eAAe,EAAE,YAAY,EAAE,gBAAgB,EAAE,aAAa,EAAE,YAAY,EAAE,aAAa,CAAC,EAAE,OAAO,CAAC,CAAC;KACtN;CACJ,CAAA,CAAE,UAAU,OAAO,EAAE,OAAO,EAAE;AAC3B,gBAAY,CAAC;;AACb,QAAI,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC5B,QAAI,SAAS,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACtC,QAAI,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AAClC,QAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACrC,QAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,QAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,QAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC/B,QAAI,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC7C,QAAI,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACvC,QAAI,cAAc,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC/C,QAAI,WAAW,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACzC,QAAI,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACvC,QAAI,WAAW,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACzC,aAAS,aAAa,CAAC,CAAC,EAAE,EAAE,EAAE;AAC1B,YAAI,CAAC,YAAY,OAAO,CAAC,KAAK,EAAE;kBACpB,GAAG,GAAY,CAAC,CAAhB,GAAG;kBAAE,KAAK,GAAK,CAAC,CAAX,KAAK;;AAClB,qBAAS,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC;AACrE,uBAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;SAC9B,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,IAAI,EAAE;kBACxB,MAAM,GAAW,CAAC,CAAlB,MAAM;kBAAE,IAAI,GAAK,CAAC,CAAV,IAAI;;AACpB,uBAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AAC5B,kBAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;SACtC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,IAAI,EAAE;kBACxB,OAAO,GAAoB,CAAC,CAA5B,OAAO;kBAAE,KAAK,GAAa,CAAC,CAAnB,KAAK;kBAAE,MAAM,GAAK,CAAC,CAAZ,MAAM;;AAC9B,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,qBAAS,CAAC,aAAa,CAAC,EAAE,EAAE,MAAM;AAC9B,sBAAM,IAAI,GAAG,MAAM;AACf,yBAAK,MAAM,CAAC,IAAI,KAAK,EACjB,cAAc,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,wBAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,IAAI,aAAa,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;iBAChE,CAAC;AACF,oBAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI;AACtB,8BAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AACtB,4BAAQ,CAAC,kBAAkB,CAAC,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;iBACjD,EAAE,IAAI,CAAC,CAAC;aACZ,CAAC,CAAC;SACN,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,IAAI,EAAE;kBACxB,IAAI,GAAsB,CAAC,CAA3B,IAAI;kBAAE,MAAM,GAAc,CAAC,CAArB,MAAM;kBAAE,OAAO,GAAK,CAAC,CAAb,OAAO;;AAC7B,uBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC1B,sBAAU,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;AAC/B,sBAAU,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;SACnC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,WAAW,EAAE;kBAC/B,IAAI,GAAa,CAAC,CAAlB,IAAI;kBAAE,MAAM,GAAK,CAAC,CAAZ,MAAM;;AACpB,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,uBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC1B,qBAAS,CAAC,UAAU,CAAC,MAAM,YAAY,OAAO,CAAC,KAAK,IAAI,EAAE,KAAK,CAAC,EAAE,MAAM;AACpE,oBAAI,MAAM,YAAY,OAAO,CAAC,KAAK,EAC/B,aAAa,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,KAExC,UAAU,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;aACtC,CAAC,CAAC;SACN,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,GAAG,EAAE;kBACvB,MAAM,GAAW,CAAC,CAAlB,MAAM;kBAAE,IAAI,GAAK,CAAC,CAAV,IAAI;;AACpB,uBAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AAC5B,uBAAW,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;SACnC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,MAAM,EAChC,cAAc,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAC7B,IAAI,CAAC,YAAY,OAAO,CAAC,GAAG,EAAE;AAC/B,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,uBAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;SAC1B,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,EAAE;kBAC5B,GAAG,GAAsB,CAAC,CAA1B,GAAG;kBAAE,QAAQ,GAAY,CAAC,CAArB,QAAQ;kBAAE,KAAK,GAAK,CAAC,CAAX,KAAK;;AAC5B,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,qBAAS,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,IAAI,SAAS,CAAC,OAAO,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,kBAAkB,CAAC,CAAC;AACrF,uBAAW,CAAC,kBAAkB,CAAC,QAAQ,EAAE,MAAM;AAC3C,yBAAS,CAAC,OAAO,CAAC,CAAC,EAAE,MAAM;AACvB,iCAAa,CAAC,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;iBAC9D,CAAC,CAAC;aACN,CAAC,CAAC;SACN,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,SAAS,EAAE;kBAC7B,GAAG,GAAW,CAAC,CAAf,GAAG;kBAAE,IAAI,GAAK,CAAC,CAAV,IAAI;;AACjB,kBAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;AAChG,qBAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AACjD,gBAAI,IAAI,YAAY,OAAO,CAAC,WAAW,EAAE;AACrC,yBAAS,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAAC,CAAC;AAC5D,yBAAS,CAAC,OAAO,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;aACrD;AACD,uBAAW,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;SACnC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,MAAM,EAAE;kBAC1B,QAAQ,GAAoB,CAAC,CAA7B,QAAQ;kBAAE,KAAK,GAAa,CAAC,CAAnB,KAAK;kBAAE,MAAM,GAAK,CAAC,CAAZ,MAAM;;AAC/B,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,qBAAS,CAAC,aAAa,CAAC,EAAE,EAAE,MAAM;AAC9B,yBAAS,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM;AAC/B,+BAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC9B,yBAAK,MAAM,CAAC,IAAI,KAAK,EACjB,gBAAgB,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC5B,wBAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,IAAI,aAAa,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;iBAChE,CAAC,CAAC;aACN,CAAC,CAAC;SACN,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,KAAK,EAAE;AACjC,uBAAW,CAAC,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;SACvC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,IAAI,EAAE;kBACxB,KAAK,GAAqB,CAAC,CAA3B,KAAK;kBAAE,OAAO,GAAY,CAAC,CAApB,OAAO;kBAAE,KAAK,GAAK,CAAC,CAAX,KAAK;;AAC7B,gBAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,uBAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAC3B,qBAAS,CAAC,aAAa,CAAC,EAAE,EAAE,MAAM;AAC9B,oBAAI,EAAE,KAAK,CAAC,EACR,MAAM,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;AAC3C,wBAAQ,CAAC,kBAAkB,CAAC,OAAO,EAAE,MAAM;AACvC,iCAAa,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;iBACtC,CAAC,CAAC;aACN,CAAC,CAAC;SACN,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,KAAK,EAAE;kBACzB,GAAG,GAAc,CAAC,CAAlB,GAAG;kBAAE,OAAO,GAAK,CAAC,CAAb,OAAO;;AACpB,qBAAS,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;AAC1E,uBAAW,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;SACpC,MACI,IAAI,CAAC,YAAY,OAAO,CAAC,OAAO,EAAE;kBAC3B,GAAG,GAAY,CAAC,CAAhB,GAAG;kBAAE,KAAK,GAAK,CAAC,CAAX,KAAK;;AAClB,qBAAS,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;AAC1E,uBAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;SAC9B,MACI;AACD,kBAAM,IAAI,KAAK,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SACvC;KACJ;AACD,UAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,WAAO,CAAC,OAAO,GAAG,aAAa,CAAC;AAChC,aAAS,cAAc,OAAmB,EAAE,EAAE;YAApB,IAAI,QAAJ,IAAI;YAAE,MAAM,QAAN,MAAM;;AAClC,YAAI,IAAI,YAAY,OAAO,CAAC,OAAO,EAAE;AACjC,uBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC/B,uBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;AACpC,oBAAQ,CAAC,mBAAmB,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,aAAa,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC;SAC5F,MACI;AACD,uBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC1B,yBAAa,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;SAC3C;KACJ;AACD,aAAS,gBAAgB,CAAC,CAAC,EAAE,EAAE,EAAE;cACrB,MAAM,GAAa,CAAC,CAApB,MAAM;cAAE,MAAM,GAAK,CAAC,CAAZ,MAAM;;AACtB,YAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC1B,mBAAW,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAClC,qBAAa,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;KAC3C;CACJ,CAAC,CAAC","file":"private/verify/verifyValOrDo.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../MsAst', './context', './locals', './SK', './util', './verifyBlock', './verifyDo', './verifyExcept', './verifyFor', './verifySK', './verifyVal'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var context_1 = require('../context');\n    var MsAst_1 = require('../MsAst');\n    var context_2 = require('./context');\n    var locals_1 = require('./locals');\n    var SK_1 = require('./SK');\n    var util_1 = require('./util');\n    var verifyBlock_1 = require('./verifyBlock');\n    var verifyDo_1 = require('./verifyDo');\n    var verifyExcept_1 = require('./verifyExcept');\n    var verifyFor_1 = require('./verifyFor');\n    var verifySK_1 = require('./verifySK');\n    var verifyVal_1 = require('./verifyVal');\n    function verifyValOrDo(_, sk) {\n        if (_ instanceof MsAst_1.Await) {\n            const { loc, value } = _;\n            context_1.check(context_2.funKind === 1, loc, _ => _.misplacedAwait);\n            verifyVal_1.default(value);\n        }\n        else if (_ instanceof MsAst_1.Call) {\n            const { called, args } = _;\n            verifyVal_1.default(called);\n            util_1.verifyEachValOrSpread(args);\n        }\n        else if (_ instanceof MsAst_1.Case) {\n            const { opCased, parts, opElse } = _;\n            SK_1.markStatement(_, sk);\n            context_2.withIifeIfVal(sk, () => {\n                const doIt = () => {\n                    for (const _ of parts)\n                        verifyCasePart(_, sk);\n                    Op_1.opEach(opElse, _ => verifyBlock_1.verifyBlockSK(_, sk));\n                };\n                Op_1.caseOp(opCased, _ => {\n                    verifyDo_1.default(_);\n                    locals_1.verifyAndPlusLocal(_.assignee, doIt);\n                }, doIt);\n            });\n        }\n        else if (_ instanceof MsAst_1.Cond) {\n            const { test, ifTrue, ifFalse } = _;\n            verifyVal_1.default(test);\n            verifySK_1.default(ifTrue, sk);\n            verifySK_1.default(ifFalse, sk);\n        }\n        else if (_ instanceof MsAst_1.Conditional) {\n            const { test, result } = _;\n            SK_1.markStatement(_, sk);\n            verifyVal_1.default(test);\n            context_2.withIifeIf(result instanceof MsAst_1.Block && sk === 1, () => {\n                if (result instanceof MsAst_1.Block)\n                    verifyBlock_1.verifyBlockSK(result, sk);\n                else\n                    verifySK_1.default(result, sk);\n            });\n        }\n        else if (_ instanceof MsAst_1.Del) {\n            const { subbed, args } = _;\n            verifyVal_1.default(subbed);\n            verifyVal_1.verifyEachVal(args);\n        }\n        else if (_ instanceof MsAst_1.Except)\n            verifyExcept_1.default(_, sk);\n        else if (_ instanceof MsAst_1.For) {\n            SK_1.markStatement(_, sk);\n            verifyFor_1.default(_);\n        }\n        else if (_ instanceof MsAst_1.ForAsync) {\n            const { loc, iteratee, block } = _;\n            SK_1.markStatement(_, sk);\n            context_1.check(sk !== 0 || context_2.funKind === 1, loc, _ => _.forAsyncNeedsAsync);\n            verifyFor_1.withVerifyIteratee(iteratee, () => {\n                context_2.withFun(1, () => {\n                    verifyBlock_1.verifyBlockSK(block, SK_1.getBlockSK(block));\n                });\n            });\n        }\n        else if (_ instanceof MsAst_1.SuperCall) {\n            const { loc, args } = _;\n            const meth = Op_1.orThrow(context_2.method, () => context_1.fail(loc, _ => _.superNeedsMethod));\n            context_2.results.superCallToMethod.set(_, meth);\n            if (meth instanceof MsAst_1.Constructor) {\n                context_1.check(sk === 0, loc, _ => _.superMustBeStatement);\n                context_2.results.constructorToSuper.set(meth, _);\n            }\n            verifyVal_1.verifyEachVal(args);\n        }\n        else if (_ instanceof MsAst_1.Switch) {\n            const { switched, parts, opElse } = _;\n            SK_1.markStatement(_, sk);\n            context_2.withIifeIfVal(sk, () => {\n                context_2.withInSwitch(true, () => {\n                    verifyVal_1.default(switched);\n                    for (const _ of parts)\n                        verifySwitchPart(_, sk);\n                    Op_1.opEach(opElse, _ => verifyBlock_1.verifyBlockSK(_, sk));\n                });\n            });\n        }\n        else if (_ instanceof MsAst_1.Throw) {\n            verifyVal_1.verifyOpVal(_.opThrown);\n        }\n        else if (_ instanceof MsAst_1.With) {\n            const { value, declare, block } = _;\n            SK_1.markStatement(_, sk);\n            verifyVal_1.default(value);\n            context_2.withIifeIfVal(sk, () => {\n                if (sk === 1)\n                    util_1.makeUseOptionalIfFocus(declare);\n                locals_1.verifyAndPlusLocal(declare, () => {\n                    verifyBlock_1.verifyBlockDo(block);\n                });\n            });\n        }\n        else if (_ instanceof MsAst_1.Yield) {\n            const { loc, opValue } = _;\n            context_1.check(context_2.funKind === 2, loc, _ => _.misplacedYield(112));\n            verifyVal_1.verifyOpVal(opValue);\n        }\n        else if (_ instanceof MsAst_1.YieldTo) {\n            const { loc, value } = _;\n            context_1.check(context_2.funKind === 2, loc, _ => _.misplacedYield(113));\n            verifyVal_1.default(value);\n        }\n        else {\n            throw new Error(_.constructor.name);\n        }\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = verifyValOrDo;\n    function verifyCasePart({ test, result }, sk) {\n        if (test instanceof MsAst_1.Pattern) {\n            verifyVal_1.default(test.type);\n            verifyVal_1.default(test.patterned);\n            locals_1.verifyAndPlusLocals(test.locals, () => verifyBlock_1.verifyBlockSK(result, sk));\n        }\n        else {\n            verifyVal_1.default(test);\n            verifyBlock_1.verifyBlockSK(result, sk);\n        }\n    }\n    function verifySwitchPart(_, sk) {\n        const { values, result } = _;\n        SK_1.markStatement(_, sk);\n        verifyVal_1.verifyEachVal(values);\n        verifyBlock_1.verifyBlockSK(result, sk);\n    }\n});\n"],"sourceRoot":"/source/"}