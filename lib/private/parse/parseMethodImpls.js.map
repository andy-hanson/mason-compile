{"version":3,"sources":["private/parse/parseMethodImpls.js"],"names":[],"mappings":"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","file":"private/parse/parseMethodImpls.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", '../ast/classTraitCommon', '../ast/Quote', '../context', '../token/Keyword', './parseBlock', './parseExpr', './parseFunBlock', './parseMethodSplit'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var classTraitCommon_1 = require('../ast/classTraitCommon');\n    var Quote_1 = require('../ast/Quote');\n    var context_1 = require('../context');\n    var Keyword_1 = require('../token/Keyword');\n    var parseBlock_1 = require('./parseBlock');\n    var parseExpr_1 = require('./parseExpr');\n    var parseFunBlock_1 = require('./parseFunBlock');\n    var parseMethodSplit_1 = require('./parseMethodSplit');\n    function parseMethodImpls(lines) {\n        return lines.mapSlices(parseMethodImpl);\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = parseMethodImpls;\n    function takeStatics(lines) {\n        if (lines.isEmpty())\n            return [[], lines];\n        else {\n            const line = lines.headSlice();\n            return Keyword_1.isKeyword(144, line.head()) ?\n                [parseMethodImpls(parseBlock_1.justBlock(144, line.tail())), lines.tail()] :\n                [[], lines];\n        }\n    }\n    exports.takeStatics = takeStatics;\n    function parseStaticsAndMethods(lines) {\n        const [statics, rest] = takeStatics(lines);\n        return [statics, parseMethodImpls(rest)];\n    }\n    exports.parseStaticsAndMethods = parseStaticsAndMethods;\n    function opTakeDo(lines) {\n        const line = lines.headSlice();\n        return Keyword_1.isKeyword(94, line.head()) ?\n            [new classTraitCommon_1.ClassTraitDo(line.loc, parseBlock_1.parseJustBlock(94, line.tail())), lines.tail()] :\n            [null, lines];\n    }\n    exports.opTakeDo = opTakeDo;\n    function parseMethodImpl(tokens) {\n        const [[isMy, isVirtual, isOverride], rest] = tokens.takeKeywords(130, 155, 137);\n        const kind = methodKind(tokens.loc, isMy, isVirtual, isOverride);\n        const head = rest.head();\n        if (isGetSet(head)) {\n            const [before, block] = parseBlock_1.beforeAndBlock(rest.tail());\n            const ctr = head.kind === 120 ? classTraitCommon_1.MethodGetter : classTraitCommon_1.MethodSetter;\n            return new ctr(rest.loc, parseExprOrQuoteSimple(before), parseBlock_1.default(block), kind);\n        }\n        else {\n            const { before, kind: funKind, after } = parseMethodSplit_1.default(rest);\n            const fun = parseFunBlock_1.default(funKind, after);\n            return new classTraitCommon_1.MethodImpl(rest.loc, parseExprOrQuoteSimple(before), fun, kind);\n        }\n    }\n    function methodKind(loc, isMy, isVirtual, isOverride) {\n        context_1.check(!(isMy && isOverride), loc, _ => _.noMyOverride);\n        const m = isMy ? 0b100 : 0;\n        const v = isVirtual ? 0b010 : 0;\n        const o = isOverride ? 0b001 : 0;\n        return m | v | o;\n    }\n    function isGetSet(token) {\n        if (token instanceof Keyword_1.default)\n            return token.kind === 120 || token.kind === 142;\n        else\n            return null;\n    }\n    function parseExprOrQuoteSimple(tokens) {\n        const expr = parseExpr_1.default(tokens);\n        return expr instanceof Quote_1.QuoteSimple ? expr.value : expr;\n    }\n});\n"],"sourceRoot":"/source/"}